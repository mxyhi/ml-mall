import{_ as C,ap as A,G as $,bf as L,r as R,at as S,A as q,Q as M,au as N,s as n,H as F,b as r,V as p,x as l,bg as I,aC as G,bh as T,v as i,K as d,y as m,W as H,bi as Z}from"./user-29809695.js";import{C as h}from"./index-7a85a8f6.js";import{R as j,a as E}from"./index-baad5075.js";import"./index-afe6215c.js";import"./index-7103e571.js";import{F as K}from"./index-5590cd64.js";import{r as O,a as Q}from"./auth-c9dcc3c5.js";import{g as W}from"./avatar-49c9b4b4.js";import{F as J,b as y}from"./function-call-63a7fb69.js";import"./use-id-06bdbb62.js";const P={class:"container"},X={class:"user_img"},Y=["src"],D={style:{margin:"16px"}},ee={__name:"Login",setup(ae){const _=W(),g=()=>({avatar:_,username:"",password:"",sex:1,sign:"",secretAnswer:""});function V(t,e){console.log(t,e)}V(...[1,2]);const a=A(g());let c=!1;$(L(a,"username"),t=>{const e=Z(t).avatar;c?(a.avatar=_,c=!1):e&&(a.avatar=e,c=!0)});const o=R(!1),b=S(),w=q(),x=async t=>{if(console.table(t),o.value){const e=await O(t);e.code===1&&(y({message:"注册成功",duration:1500}),Object.assign(a,g()),a.username=t.name,a.avatar=t.avatar,o.value=!1,console.log(a)),console.log(e)}else{const e=await Q(t);console.log(e),e.code===1&&(y({message:"登录成功",duration:1500}),w.setInfo({name:t.name,avatar:e.data.avatar,sign:e.data.sign,sex:e.data.sex}),I(e.data.token,e.data.expires_in),G(),T(t.name,{avatar:e.data.avatar,pwd:t.password,sign:e.data.sign,sex:e.data.sex,lastLogin:!0}),b.replace("/home"))}};return(t,e)=>{const k=M,u=K,f=j,U=E,z=h,v=N,B=J;return n(),F("main",null,[r(k,{title:o.value?"注册":t.$route.meta.title,"left-arrow":"",onClickLeft:e[0]||(e[0]=s=>t.$router.replace("/home")),fixed:""},null,8,["title"]),p("div",P,[p("div",X,[p("img",{src:a.avatar},null,8,Y)]),r(B,{onSubmit:x},{default:l(()=>[r(z,{inset:""},{default:l(()=>[r(u,{modelValue:a.username,"onUpdate:modelValue":e[1]||(e[1]=s=>a.username=s),modelModifiers:{lazy:!0,trim:!0},name:"name",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"},{pattern:/^[-_a-zA-Z0-9]{4,16}$/,message:"只能包含4-16位字母数字下划线减号"}]},null,8,["modelValue"]),r(u,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=s=>a.password=s),modelModifiers:{lazy:!0,trim:!0},type:"password",name:"password",autocomplete:"",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"},{pattern:/^[-_a-zA-Z0-9]{6,16}$/,message:"只能包含6-16位字母数字下划线减号"}]},null,8,["modelValue"]),o.value?(n(),i(u,{key:0,modelValue:a.avatar,"onUpdate:modelValue":e[3]||(e[3]=s=>a.avatar=s),modelModifiers:{lazy:!0,trim:!0},type:"url",name:"avatar",label:"头像",placeholder:"图片地址",rules:[{required:!0,message:"请填写图片地址"},{pattern:/^(http|ftp|https):\/\/([\w\-]+(\.[\w\-]+)*\/)*[\w\-]+(\.[\w\-]+)*\/?(\?([\w\-\.,@?^=%&:\/~\+#]*)+)?/,message:"请输入有效的网址"}]},null,8,["modelValue","rules"])):d("",!0),o.value?(n(),i(u,{key:1,name:"sex",label:"性别"},{input:l(()=>[r(U,{modelValue:a.sex,"onUpdate:modelValue":e[4]||(e[4]=s=>a.sex=s),direction:"horizontal"},{default:l(()=>[r(f,{name:1},{default:l(()=>[m("男")]),_:1}),r(f,{name:0},{default:l(()=>[m("女")]),_:1})]),_:1},8,["modelValue"])]),_:1})):d("",!0),o.value?(n(),i(u,{key:2,modelValue:a.sign,"onUpdate:modelValue":e[5]||(e[5]=s=>a.sign=s),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"sign",label:"签名",placeholder:"个性签名",rules:[{required:!0,message:"请填写个性签名"}]},null,8,["modelValue"])):d("",!0),o.value?(n(),i(u,{key:3,modelValue:a.secretAnswer,"onUpdate:modelValue":e[6]||(e[6]=s=>a.secretAnswer=s),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"secret_answer",label:"密保",placeholder:"验证密保",rules:[{required:!0,message:"请填写密保"}]},null,8,["modelValue"])):d("",!0)]),_:1}),p("div",D,[r(v,{round:"",block:"",type:o.value?"primary":"success","native-type":"submit"},{default:l(()=>[m(H(o.value?"注册":"登录"),1)]),_:1},8,["type"]),o.value?d("",!0):(n(),i(v,{key:0,class:"registerBtn",round:"",block:"",type:"primary",onClick:e[7]||(e[7]=s=>o.value=!0)},{default:l(()=>[m(" 注册 ")]),_:1})),o.value?(n(),i(v,{key:1,class:"registerBtn",round:"",block:"",plain:"",type:"primary",onClick:e[8]||(e[8]=s=>o.value=!1)},{default:l(()=>[m(" 返回登录 ")]),_:1})):d("",!0)])]),_:1})])])}}},ce=C(ee,[["__scopeId","data-v-f57a0a2a"]]);export{ce as default};
