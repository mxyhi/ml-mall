import{_ as C,a8 as $,D as q,b1 as A,r as L,at as N,x as R,o as n,E as S,a as r,ai as p,q as l,b2 as M,av as I,b3 as F,p as i,G as d,s as m,af as G,b4 as T}from"./user-0dd1e069.js";/* empty css              */import{C as E}from"./index-7d45a195.js";import{R as Z,a as j}from"./index-41b70d56.js";import"./index-0ad94edc.js";import"./index-d4ce09a5.js";import{F as H,a as O,s as y}from"./index-a35333a5.js";import{N as J}from"./index-17d6a68d.js";import{a as K,b as P}from"./auth-a612d56d.js";import{g as Q}from"./avatar-49c9b4b4.js";import{B as W}from"./index-c1d7c59c.js";import"./use-route-f9688e52.js";import"./use-id-d165ec44.js";const X={class:"container"},Y={class:"user_img"},h=["src"],D={style:{margin:"16px"}},ee={__name:"Login",setup(ae){const _=Q(),g=()=>({avatar:_,username:"",password:"",sex:"1",sign:"",secretAnswer:""});function b(t,e){console.log(t,e)}b(...[1,2]);const a=$(g());let c=!1;q(A(a,"username"),t=>{const e=T(t).avatar;c?(a.avatar=_,c=!1):e&&(a.avatar=e,c=!0)});const o=L(!1),w=N(),V=R(),k=async t=>{if(console.table(t),o.value){const e=await K(t);e.code===1&&(y({message:"注册成功",duration:1500}),Object.assign(a,g()),a.username=t.name,a.avatar=t.avatar,o.value=!1,console.log(a)),console.log(e)}else{const e=await P(t);console.log(e),e.code===1&&(y({message:"登录成功",duration:1500}),V.setInfo({name:t.name,avatar:e.data.avatar,sign:e.data.sign,sex:e.data.sex}),M(e.data.token,e.data.expires_in),I(),F(t.name,{avatar:e.data.avatar,pwd:t.password,sign:e.data.sign,sex:e.data.sex,lastLogin:!0}),w.replace("/home"))}};return(t,e)=>{const x=J,u=H,f=Z,B=j,U=E,v=W,z=O;return n(),S("main",null,[r(x,{title:o.value?"注册":t.$route.meta.title,"left-arrow":"",onClickLeft:e[0]||(e[0]=s=>t.$router.back()),fixed:""},null,8,["title"]),p("div",X,[p("div",Y,[p("img",{src:a.avatar},null,8,h)]),r(z,{onSubmit:k},{default:l(()=>[r(U,{inset:""},{default:l(()=>[r(u,{modelValue:a.username,"onUpdate:modelValue":e[1]||(e[1]=s=>a.username=s),modelModifiers:{lazy:!0,trim:!0},name:"name",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"},{pattern:/^[-_a-zA-Z0-9]{4,16}$/,message:"只能包含4-16位字母数字下划线减号"}]},null,8,["modelValue"]),r(u,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=s=>a.password=s),modelModifiers:{lazy:!0,trim:!0},type:"password",name:"password",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"},{pattern:/^[-_a-zA-Z0-9]{6,16}$/,message:"只能包含6-16位字母数字下划线减号"}]},null,8,["modelValue"]),o.value?(n(),i(u,{key:0,modelValue:a.avatar,"onUpdate:modelValue":e[3]||(e[3]=s=>a.avatar=s),modelModifiers:{lazy:!0,trim:!0},type:"url",name:"avatar",label:"头像",placeholder:"图片地址",rules:[{required:!0,message:"请填写图片地址"},{pattern:/^(http|ftp|https):\/\/([\w\-]+(\.[\w\-]+)*\/)*[\w\-]+(\.[\w\-]+)*\/?(\?([\w\-\.,@?^=%&:\/~\+#]*)+)?/,message:"请输入有效的网址"}]},null,8,["modelValue","rules"])):d("",!0),o.value?(n(),i(u,{key:1,name:"radio",label:"性别"},{input:l(()=>[r(B,{modelValue:a.sex,"onUpdate:modelValue":e[4]||(e[4]=s=>a.sex=s),direction:"horizontal"},{default:l(()=>[r(f,{name:"1"},{default:l(()=>[m("男")]),_:1}),r(f,{name:"0"},{default:l(()=>[m("女")]),_:1})]),_:1},8,["modelValue"])]),_:1})):d("",!0),o.value?(n(),i(u,{key:2,modelValue:a.sign,"onUpdate:modelValue":e[5]||(e[5]=s=>a.sign=s),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"sign",label:"签名",placeholder:"个性签名",rules:[{required:!0,message:"请填写个性签名"}]},null,8,["modelValue"])):d("",!0),o.value?(n(),i(u,{key:3,modelValue:a.secretAnswer,"onUpdate:modelValue":e[6]||(e[6]=s=>a.secretAnswer=s),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"secret_answer",label:"密保",placeholder:"验证密保",rules:[{required:!0,message:"请填写密保"}]},null,8,["modelValue"])):d("",!0)]),_:1}),p("div",D,[r(v,{round:"",block:"",type:o.value?"primary":"success","native-type":"submit"},{default:l(()=>[m(G(o.value?"注册":"登录"),1)]),_:1},8,["type"]),o.value?d("",!0):(n(),i(v,{key:0,class:"registerBtn",round:"",block:"",type:"primary",onClick:e[7]||(e[7]=s=>o.value=!0)},{default:l(()=>[m(" 注册 ")]),_:1})),o.value?(n(),i(v,{key:1,class:"registerBtn",round:"",block:"",plain:"",type:"primary",onClick:e[8]||(e[8]=s=>o.value=!1)},{default:l(()=>[m(" 返回登录 ")]),_:1})):d("",!0)])]),_:1})])])}}},ge=C(ee,[["__scopeId","data-v-6396ef33"]]);export{ge as default};
