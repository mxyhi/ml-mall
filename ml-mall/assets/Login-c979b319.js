import{_ as q,am as C,E as $,ba as A,r as L,aq as N,y as R,p as n,F as S,b as r,U as p,s as l,bb as F,az as M,bc as I,q as i,H as m,v as d,V as T,bd as E}from"./user-0aef1c91.js";/* empty css              *//* empty css              */import{C as G}from"./index-3b975ccb.js";import{R as H,a as Z}from"./index-4969e190.js";import"./index-d4b43d7f.js";import"./index-517c6840.js";import{F as j}from"./index-e62943ec.js";import{N as O}from"./index-7f807b9d.js";import{r as h,a as J}from"./auth-1d2729d8.js";import{g as K}from"./avatar-49c9b4b4.js";import{F as P,b as y}from"./function-call-57b65173.js";import{B as Q}from"./index-98a02491.js";import"./use-route-dd9e823b.js";import"./use-id-90fe8789.js";import"./index-47ddee7f.js";const W={class:"container"},X={class:"user_img"},Y=["src"],D={style:{margin:"16px"}},ee={__name:"Login",setup(ae){const _=K(),g=()=>({avatar:_,username:"",password:"",sex:1,sign:"",secretAnswer:""});function b(t,e){console.log(t,e)}b(...[1,2]);const a=C(g());let c=!1;$(A(a,"username"),t=>{const e=E(t).avatar;c?(a.avatar=_,c=!1):e&&(a.avatar=e,c=!0)});const o=L(!1),V=N(),w=R(),k=async t=>{if(console.table(t),o.value){const e=await h(t);e.code===1&&(y({message:"注册成功",duration:1500}),Object.assign(a,g()),a.username=t.name,a.avatar=t.avatar,o.value=!1,console.log(a)),console.log(e)}else{const e=await J(t);console.log(e),e.code===1&&(y({message:"登录成功",duration:1500}),w.setInfo({name:t.name,avatar:e.data.avatar,sign:e.data.sign,sex:e.data.sex}),F(e.data.token,e.data.expires_in),M(),I(t.name,{avatar:e.data.avatar,pwd:t.password,sign:e.data.sign,sex:e.data.sex,lastLogin:!0}),V.replace("/home"))}};return(t,e)=>{const x=O,u=j,f=H,U=Z,z=G,v=Q,B=P;return n(),S("main",null,[r(x,{title:o.value?"注册":t.$route.meta.title,"left-arrow":"",onClickLeft:e[0]||(e[0]=s=>t.$router.replace("/home")),fixed:""},null,8,["title"]),p("div",W,[p("div",X,[p("img",{src:a.avatar},null,8,Y)]),r(B,{onSubmit:k},{default:l(()=>[r(z,{inset:""},{default:l(()=>[r(u,{modelValue:a.username,"onUpdate:modelValue":e[1]||(e[1]=s=>a.username=s),modelModifiers:{lazy:!0,trim:!0},name:"name",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"},{pattern:/^[-_a-zA-Z0-9]{4,16}$/,message:"只能包含4-16位字母数字下划线减号"}]},null,8,["modelValue"]),r(u,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=s=>a.password=s),modelModifiers:{lazy:!0,trim:!0},type:"password",name:"password",autocomplete:"",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"},{pattern:/^[-_a-zA-Z0-9]{6,16}$/,message:"只能包含6-16位字母数字下划线减号"}]},null,8,["modelValue"]),o.value?(n(),i(u,{key:0,modelValue:a.avatar,"onUpdate:modelValue":e[3]||(e[3]=s=>a.avatar=s),modelModifiers:{lazy:!0,trim:!0},type:"url",name:"avatar",label:"头像",placeholder:"图片地址",rules:[{required:!0,message:"请填写图片地址"},{pattern:/^(http|ftp|https):\/\/([\w\-]+(\.[\w\-]+)*\/)*[\w\-]+(\.[\w\-]+)*\/?(\?([\w\-\.,@?^=%&:\/~\+#]*)+)?/,message:"请输入有效的网址"}]},null,8,["modelValue","rules"])):m("",!0),o.value?(n(),i(u,{key:1,name:"sex",label:"性别"},{input:l(()=>[r(U,{modelValue:a.sex,"onUpdate:modelValue":e[4]||(e[4]=s=>a.sex=s),direction:"horizontal"},{default:l(()=>[r(f,{name:1},{default:l(()=>[d("男")]),_:1}),r(f,{name:0},{default:l(()=>[d("女")]),_:1})]),_:1},8,["modelValue"])]),_:1})):m("",!0),o.value?(n(),i(u,{key:2,modelValue:a.sign,"onUpdate:modelValue":e[5]||(e[5]=s=>a.sign=s),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"sign",label:"签名",placeholder:"个性签名",rules:[{required:!0,message:"请填写个性签名"}]},null,8,["modelValue"])):m("",!0),o.value?(n(),i(u,{key:3,modelValue:a.secretAnswer,"onUpdate:modelValue":e[6]||(e[6]=s=>a.secretAnswer=s),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"secret_answer",label:"密保",placeholder:"验证密保",rules:[{required:!0,message:"请填写密保"}]},null,8,["modelValue"])):m("",!0)]),_:1}),p("div",D,[r(v,{round:"",block:"",type:o.value?"primary":"success","native-type":"submit"},{default:l(()=>[d(T(o.value?"注册":"登录"),1)]),_:1},8,["type"]),o.value?m("",!0):(n(),i(v,{key:0,class:"registerBtn",round:"",block:"",type:"primary",onClick:e[7]||(e[7]=s=>o.value=!0)},{default:l(()=>[d(" 注册 ")]),_:1})),o.value?(n(),i(v,{key:1,class:"registerBtn",round:"",block:"",plain:"",type:"primary",onClick:e[8]||(e[8]=s=>o.value=!1)},{default:l(()=>[d(" 返回登录 ")]),_:1})):m("",!0)])]),_:1})])])}}},be=q(ee,[["__scopeId","data-v-f57a0a2a"]]);export{be as default};
