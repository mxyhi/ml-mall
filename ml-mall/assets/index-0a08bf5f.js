import{c as k,d as L,aq as I,a as o,e as E,I as R,V as S,n as V,t as B,w as p,m as D,a7 as A,r as h,aJ as N,D as $,aK as q,A as y,T as U,ab as J,M,Q as w,aL as O,_ as j,at as z,o as F,E as G,q as H}from"./user-0dd1e069.js";/* empty css              */import{T as K}from"./index-2c5a2d28.js";import{C as Q}from"./index-d4ce09a5.js";import{R as W,a as X}from"./index-41b70d56.js";import"./index-0ad94edc.js";import{N as Y}from"./index-17d6a68d.js";import{u as Z,g as ee}from"./address-4f1f0652.js";import{B as te,L as ae}from"./index-c1d7c59c.js";import"./use-route-f9688e52.js";const[ne,v]=k("address-item");var de=L({name:ne,props:{address:I(Object),disabled:Boolean,switchable:Boolean,defaultTagText:String},emits:["edit","click","select"],setup(e,{slots:i,emit:d}){const r=()=>{e.switchable&&d("select"),d("click")},c=()=>o(R,{name:"edit",class:v("edit"),onClick:t=>{t.stopPropagation(),d("edit"),d("click")}},null),m=()=>{if(i.tag)return i.tag(e.address);if(e.address.isDefault&&e.defaultTagText)return o(K,{type:"primary",round:!0,class:v("tag")},{default:()=>[e.defaultTagText]})},a=()=>{const{address:t,disabled:n,switchable:s}=e,u=[o("div",{class:v("name")},[`${t.name} ${t.tel}`,m()]),o("div",{class:v("address")},[t.address])];return s&&!n?o(W,{name:t.id,iconSize:18},{default:()=>[u]}):u};return()=>{var t;const{disabled:n}=e;return o("div",{class:v({disabled:n}),onClick:r},[o(Q,{border:!1,titleClass:v("title")},{title:a,"right-icon":c}),(t=i.bottom)==null?void 0:t.call(i,E({},e.address,{disabled:n}))])}}});const[se,T,oe]=k("address-list"),ie={list:S(),modelValue:V,switchable:B,disabledText:String,disabledList:S(),addButtonText:String,defaultTagText:String};var le=L({name:se,props:ie,emits:["add","edit","select","clickItem","editDisabled","selectDisabled","update:modelValue"],setup(e,{slots:i,emit:d}){const r=(a,t,n)=>{const s=()=>d(n?"editDisabled":"edit",a,t),u=()=>d("clickItem",a,t),f=()=>{d(n?"selectDisabled":"select",a,t),n||d("update:modelValue",a.id)};return o(de,{key:a.id,address:a,disabled:n,switchable:e.switchable,defaultTagText:e.defaultTagText,onEdit:s,onClick:u,onSelect:f},{bottom:i["item-bottom"],tag:i.tag})},c=(a,t)=>{if(a)return a.map((n,s)=>r(n,s,t))},m=()=>o("div",{class:[T("bottom"),"van-safe-area-bottom"]},[o(te,{round:!0,block:!0,type:"primary",text:e.addButtonText||oe("add"),class:T("add"),onClick:()=>d("add")},null)]);return()=>{var a,t;const n=c(e.list),s=c(e.disabledList,!0),u=e.disabledText&&o("div",{class:T("disabled-text")},[e.disabledText]);return o("div",{class:T()},[(a=i.top)==null?void 0:a.call(i),o(X,{modelValue:e.modelValue},{default:()=>[n]}),u,s,(t=i.default)==null?void 0:t.call(i),m()])}}});const re=p(le),[ce,b,ue]=k("list"),fe={error:Boolean,offset:D(300),loading:Boolean,disabled:Boolean,finished:Boolean,errorText:String,direction:A("down"),loadingText:String,finishedText:String,immediateCheck:B};var me=L({name:ce,props:fe,emits:["load","update:error","update:loading"],setup(e,{emit:i,slots:d}){const r=h(e.loading),c=h(),m=h(),a=Z(),t=N(c),n=()=>{M(()=>{if(r.value||e.finished||e.disabled||e.error||(a==null?void 0:a.value)===!1)return;const{offset:l,direction:x}=e,g=w(t);if(!g.height||O(c))return;let _=!1;const C=w(m);x==="up"?_=g.top-C.top<=l:_=C.bottom-g.bottom<=l,_&&(r.value=!0,i("update:loading",!0),i("load"))})},s=()=>{if(e.finished){const l=d.finished?d.finished():e.finishedText;if(l)return o("div",{class:b("finished-text")},[l])}},u=()=>{i("update:error",!1),n()},f=()=>{if(e.error){const l=d.error?d.error():e.errorText;if(l)return o("div",{role:"button",class:b("error-text"),tabindex:0,onClick:u},[l])}},P=()=>{if(r.value&&!e.finished&&!e.disabled)return o("div",{class:b("loading")},[d.loading?d.loading():o(ae,{class:b("loading-icon")},{default:()=>[e.loadingText||ue("loading")]})])};return $(()=>[e.loading,e.finished,e.error],n),a&&$(a,l=>{l&&n()}),q(()=>{r.value=e.loading}),y(()=>{e.immediateCheck&&n()}),U({check:n}),J("scroll",n,{target:t,passive:!0}),()=>{var l;const x=(l=d.default)==null?void 0:l.call(d),g=o("div",{ref:m,class:b("placeholder")},null);return o("div",{ref:c,role:"feed",class:b(),"aria-busy":r.value},[e.direction==="down"?x:g,P(),s(),f(),e.direction==="up"?x:g])}}});const ge=p(me);const ve={class:"container"},be={__name:"index",setup(e){const i=z(),d=h([]),r=h([]);y(async()=>{var t,n;const a=await ee({page:1,limit:10});console.log(a),a.code===1&&(d.value=a.data.list,r.value=(n=(t=a.data.list)==null?void 0:t.map)==null?void 0:n.call(t,s=>({id:s.id,name:s.name,tel:s.phone,address:s.province.concat(s.city,s.town,s.street!=="null"?s.street:"",s.detail),isDefault:!!s.is_default})),console.table(a.data.list))});const c=h("1"),m=(a,t)=>{console.log(a),i.push({path:"/edit-address",query:{addressInfo:btoa(encodeURI(JSON.stringify({...d.value[t]})))}})};return(a,t)=>{const n=Y,s=re,u=ge;return F(),G("div",ve,[o(n,{title:a.$route.meta.title,placeholder:"",fixed:"","left-arrow":"",onClickLeft:t[0]||(t[0]=f=>a.$router.back())},null,8,["title"]),o(u,{loading:a.loading,"onUpdate:loading":t[3]||(t[3]=f=>a.loading=f),finished:a.finished,"finished-text":"没有更多了",onLoad:a.onLoad},{default:H(()=>[o(s,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=f=>c.value=f),list:r.value,"default-tag-text":"默认",onAdd:t[2]||(t[2]=f=>a.$router.push("/edit-address")),onEdit:m},null,8,["modelValue","list"])]),_:1},8,["loading","finished","onLoad"])])}}},Be=j(be,[["__scopeId","data-v-3a5e76c7"]]);export{Be as default};
