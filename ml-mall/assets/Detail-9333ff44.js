import{P as $,_ as N,bm as S,z as U,at as F,r as m,E as q,l as A,Q as E,I as L,aI as P,s as h,H as g,b as n,V as t,W as i,L as z,U as H,K as M,y as x,x as O,J as R,bn as J,bo as K,av as Q,aw as W}from"./user-29809695.js";import"./index-7103e571.js";import{F as G}from"./index-5590cd64.js";/* empty css              */import{a as w}from"./recommend-1dc0f8d8.js";import{d as X,a as Y}from"./cattle-d8635d4f.js";import{I as Z}from"./index-9381fa7b.js";import"./use-id-06bdbb62.js";const ee=l=>$({method:"POST",url:"/frontend/comment/add/",data:(()=>{const d=new FormData;return Object.keys(l).forEach(v=>{d.append(v,l[v])}),d})()});const C=l=>(Q("data-v-6f2a1dd8"),l=l(),W(),l),te={class:"container"},oe={class:"content"},ae={class:"body"},se={class:"title"},le={class:"info"},ce={class:"desc"},ne={class:"created_time"},ie={class:"detail"},de={key:0,class:"comment"},re=C(()=>t("p",null,"评论:",-1)),ue={class:"content_item"},_e={class:"user_pic"},me=["src","alt"],ve={class:"item_left"},pe={class:"user_name"},fe={class:"createdTime"},he={class:"user_content"},ge={class:"action_box"},be={class:"action"},we=C(()=>t("div",null,"评论",-1)),ye={__name:"Detail",setup(l){S(a=>({"38f23eeb":R(T)}));const d=U(),v=F(),r=d.query.articleId;console.log(d.query),r||v.replace("/recommend");const e=m({}),y=async()=>{var o,f;if(!r)return;const a=await w(r);a.code===1&&(a.data.comments=(f=(o=a.data.comments)==null?void 0:o.reverse)==null?void 0:f.call(o),e.value=a.data),console.table(e.value),console.table(e.value.comments)};q(async()=>{await y(),u.value=e.value.is_praise,_.value=e.value.is_collect});const u=m(!1),I=async()=>{if(u.value){const o=await X({type:2,object_id:e.value.id});console.log(o),console.log("😓")}else{const o=await Y({type:2,object_id:e.value.id});console.log(o),console.log("👍")}const a=await w(r);console.log(a),e.value.praise=a.data.praise,u.value=e.value.is_praise=a.data.is_praise},_=m(!1),k=async()=>{if(_.value){const o=await J({type:2,object_id:e.value.id});console.log(o),console.log("💔")}else{const o=await K({type:2,object_id:e.value.id});console.log(o),console.log("💖")}const a=await w(r);console.log(a),e.value.collect=a.data.collect,_.value=e.value.is_collect=a.data.is_collect},p=m(!1),c=m(""),T=A(()=>c.value.length>0?"#2ecc71":"#ccc"),V=async()=>{if(!c.value.length)return;console.log(c.value);const a=await ee({type:2,object_id:e.value.id,content:c.value});console.log(a),p.value=!1,c.value="",y()};return(a,o)=>{const f=E,D=Z,b=L,j=G,B=P;return h(),g("div",te,[n(f,{title:a.$route.meta.title,placeholder:"",fixed:"","left-arrow":"",onClickLeft:o[0]||(o[0]=s=>a.$router.back())},null,8,["title"]),t("div",oe,[n(D,{class:"img",fit:"cover",src:e.value.picUrl},null,8,["src"]),t("div",ae,[t("p",se,i(e.value.title),1),t("div",le,[t("p",ce,i(e.value.desc),1),t("p",ne,i(e.value.createdAt),1)]),t("div",ie,i(e.value.detail),1)])]),e.value.comments?(h(),g("div",de,[re,(h(!0),g(z,null,H(e.value.comments,s=>(h(),g("div",ue,[t("div",_e,[t("img",{src:s.user.avatar,alt:s.user.name},null,8,me)]),t("div",ve,[t("div",pe,[x(i(s.user.name)+" ",1),t("span",fe,i(s.created_at),1)]),t("div",he,i(s.content),1)])]))),256))])):M("",!0),t("div",ge,[t("div",{class:"add_comment",onClick:o[1]||(o[1]=s=>p.value=!0)},[n(b,{name:"edit",size:"20px"}),x(" 评论 ")]),t("div",be,[t("div",{class:"Thumbs_action",onClick:I},[n(b,{color:u.value?"#3498db":"#767676",name:`thumb-circle${u.value?"":"-o"}`,badge:e.value.praise||"","badge-props":{offset:["10px","5px"]}},null,8,["color","name","badge"])]),t("div",{class:"star_action",onClick:k},[n(b,{color:_.value?"#f39c12":"#767676",badge:e.value.collect||"",name:`star${_.value?"":"-o"}`,"badge-props":{offset:["10px","5px"]}},null,8,["color","badge","name"])])])]),n(B,{class:"comment_box","safe-area-inset-bottom":"",show:p.value,"onUpdate:show":o[3]||(o[3]=s=>p.value=s),position:"bottom"},{default:O(()=>[t("div",{class:"comment_header"},[we,t("div",{class:"left",onClick:V},"发布")]),n(j,{"label-align":"top",modelValue:c.value,"onUpdate:modelValue":o[2]||(o[2]=s=>c.value=s),modelModifiers:{trim:!0},rows:"6",type:"textarea",maxlength:"200",placeholder:"请输入评论","show-word-limit":""},null,8,["modelValue"])]),_:1},8,["show"])])}}},Be=N(ye,[["__scopeId","data-v-6f2a1dd8"]]);export{Be as default};
